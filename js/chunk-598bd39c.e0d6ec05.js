(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-598bd39c"],{"01c0":function(t,s,e){},"20c6":function(t,s,e){},"316a":function(t,s,e){"use strict";e("6856")},3683:function(t,s,e){"use strict";e.d(s,"b",(function(){return i})),e.d(s,"a",(function(){return n})),e.d(s,"c",(function(){return r})),e.d(s,"d",(function(){return l}));var a=e("1bab");function i(t){return Object(a["b"])({url:"/playlist/detail",params:{id:t,timestamp:Date.parse(new Date)}})}function n(t){return Object(a["b"])({url:"/song/detail",params:{ids:t}})}function r(t,s){return Object(a["b"])({url:"/playlist/subscribers",params:{id:t,offset:s,limit:48}})}function l(t,s){return Object(a["b"])({url:"/playlist/subscribe",params:{t:t,id:s,timestamp:Date.parse(new Date)}})}},"3b87":function(t,s,e){"use strict";e("20c6")},"40a1":function(t,s,e){"use strict";var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"song-table"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.songs,"empty-text":"数据加载中~","row-class-name":t.tableRowClassName},on:{"row-dblclick":t.playMusic}},[e("el-table-column",{attrs:{width:"50"},scopedSlots:t._u([{key:"default",fn:function(s){return[s.row.id==t.nowSongDetail.id?e("span",{staticClass:"iconfont",class:t.isPlaying?" icon-voice":"icon-jingyin_laba"}):e("span",[t._v(t._s(t._f("formatIndex")(s.row.index)))])]}}])}),e("el-table-column",{attrs:{width:"120"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"operation"},[e("span",{class:-1!==t.likeSongIds.indexOf(s.row.id)?"iconfont icon-xihuan2":"iconfont icon-xihuan",attrs:{title:-1!==t.likeSongIds.indexOf(s.row.id)?"取消喜欢":"喜欢"},on:{click:function(e){return t.likeSong(s.row)}}}),e("span",{staticClass:"iconfont icon-xiazai",attrs:{title:"下载"},on:{click:function(e){return t.downloadCurrentMusic(s.row)}}}),e("span",{staticClass:"el-icon-plus",attrs:{title:"添加到播放列表"},on:{click:function(e){return t.addSong(s.row)}}})])]}}])}),e("el-table-column",{attrs:{prop:"name",label:"歌曲",width:"300","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"songname"},[t._v(" "+t._s(s.row.name)+" "),1==s.row.fee?e("i",{staticClass:"iconfont icon-vip"}):t._e(),0!=s.row.mv?e("i",{staticClass:"iconfont icon-mv",on:{click:function(e){return t.toMvDetail(s.row.mv)}}}):t._e()])]}}])}),e("el-table-column",{attrs:{prop:"al.name",label:"专辑","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",{staticClass:"sthover",on:{click:function(e){return t.toAlbum(s.row.al.id)}}},[t._v(" "+t._s(s.row.al.name)+" ")])]}}])}),e("el-table-column",{attrs:{prop:"ar[0].name",label:"歌手","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",{staticClass:"sthover",on:{click:function(e){return t.toSinger(s.row.ar[0].id)}}},[t._v(" "+t._s(s.row.ar[0].name)+" ")])]}}])}),e("el-table-column",{attrs:{prop:"dt",label:"时长"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",[t._v(" "+t._s(t._f("formatDuration")(s.row.dt))+" ")])]}}])})],1)],1)},i=[],n=e("5cd6"),r=e("2f62"),l={name:"SongTable",props:{songs:{type:Array,default(){return[]}}},data(){return{islike:!1,currentIndex:null}},computed:{...Object(r["b"])(["isPlaying","nowSongDetail","isLogin","userInfo","userSongList","likeSongIds"])},filters:{formatIndex(t){return t<9?"0"+(t+1):t+1}},created(){this.isLogin&&0===this.likeSongIds.length&&this.getUserLikSongs()},methods:{playMusic(t){Object(n["a"])(t.id).then(s=>{Object(n["d"])(t.id).then(t=>{this.$store.dispatch("saveSongUrl",t.data.data[0].url)}),this.$store.dispatch("changePlayState",!0),this.$store.dispatch("saveSongDetail",t),this.$store.dispatch("addPlayinglist",t)}).catch(t=>{this.$message({message:"暂时无法播放，换首试试",type:"warning",center:!0})})},getUserLikSongs(){Object(n["b"])(this.userInfo.userId).then(t=>{Array.isArray(t.data.ids)&&0!=t.data.ids.length&&this.$store.dispatch("saveLikeSongIds",t.data.ids)})},likeSong(t){if(!this.$store.state.isLogin)return void this.$message({type:"warning",message:"登录后才能收藏",showClose:!0,center:!0});let s=-1===this.likeSongIds.indexOf(t.id);this.userSongList[0].id!=this.$route.params.id?this.likeNowSongBy(t,s):this.$confirm("确定将选中歌曲从我喜欢的音乐中删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",confirmButtonClass:""}).then(()=>{this.likeNowSongBy(t,s),this.$emit("updateSonglist")}).catch(t=>{})},likeNowSongBy(t,s){Object(n["e"])(t.id,s).then(t=>{this.getUserLikSongs(),!0===s?(this.$message({message:"已添加到我喜欢的音乐",type:"success",center:!0}),this.islike=!0):(this.$message({message:"取消喜欢成功",type:"success",center:!0}),this.islike=!1)}).catch(t=>{this.$message.warning("操作失败,请重试")})},downloadCurrentMusic(t){Object(n["a"])(t.id).then(s=>{Object(n["d"])(t.id).then(s=>{let e=s.data.data[0].url,a={url:e,name:t.name+" - "+t.ar[0].name};this.$store.commit("updateDownloadMusicInfo",a)})}).catch(t=>{this.$message({message:"暂无版权，无法下载",type:"warning",center:!0})})},addSong(t){this.$store.dispatch("addPlayinglist",t),this.$message({message:"已添加到播放列表",type:"success",center:!0})},toSinger(t){this.$router.push("/singerdetail/"+t)},toAlbum(t){this.$router.push("/albumdetail/"+t)},toMvDetail(t){this.$router.push({name:"VideoDetail",params:{id:t,type:"mv"}})},tableRowClassName({row:t,rowIndex:s}){if(t.index=s,s%2!==0)return"rowEven"}}},o=l,c=(e("316a"),e("2877")),u=Object(c["a"])(o,a,i,!1,null,"2fedf183",null);s["a"]=u.exports},"46fe":function(t,s,e){"use strict";e("d3e1")},"5e65":function(t,s,e){"use strict";var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"user-list"},t._l(t.userlist,(function(t,s){return e("UserListItem",{key:s,attrs:{userlistitem:t}})})),1)},i=[],n=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"user-list-item",on:{click:t.toUserDetail}},[e("div",{staticClass:"left-avatar"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.userlistitem.avatarUrl+"?param=80y80",expression:"userlistitem.avatarUrl + '?param=80y80'"}],attrs:{alt:""}})]),e("div",{staticClass:"right-uname"},[e("p",{staticClass:"uname"},[t._v(t._s(t.userlistitem.nickname))]),e("p",{staticClass:"by"},[t._v(" "+t._s(" "==t.userlistitem.signature?"":t.userlistitem.signature)+" ")]),t.userlistitem.playlistCount?e("p",{staticClass:"info"},[e("span",[t._v("歌单:"+t._s(t.userlistitem.playlistCount))]),e("span",[t._v("粉丝:"+t._s(t.userlistitem.followeds))])]):t._e()])])},r=[],l={name:"UserListItem",props:{userlistitem:{type:Object,default(){return{}}}},methods:{toUserDetail(){this.$router.push("/userdetail/"+this.userlistitem.userId)}}},o=l,c=(e("3b87"),e("2877")),u=Object(c["a"])(o,n,r,!1,null,"ddac5b84",null),d=u.exports,p={name:"UserList",components:{UserListItem:d},props:{userlist:{type:Array,default(){return[]}}}},h=p,g=(e("f927"),Object(c["a"])(h,a,i,!1,null,"66afedbf",null));s["a"]=g.exports},6856:function(t,s,e){},"69ea":function(t,s,e){},"7ad4":function(t,s,e){"use strict";e("69ea")},b2f9:function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"w",attrs:{id:"song-list-detail"}},[e("Topdesc",{attrs:{playlist:t.playlist,"is-sub":t.isSub},on:{playAllSong:t.playAllSong,subSongListBy:t.subSongListBy}}),0!==Object.keys(t.playlist).length?e("div",{staticClass:"bot-song-list"},[e("el-tabs",[e("el-tab-pane",{attrs:{label:"歌曲列表"}},[e("SongTable",{attrs:{songs:t.songs},on:{updateSonglist:t.updateSonglist}})],1),e("el-tab-pane",[e("span",{attrs:{slot:"label"},slot:"label"},[t._v("评论")]),e("CommentPage",{attrs:{"comment-type":2,"commentres-id":t.id},on:{changePage:t.changePage}})],1),e("el-tab-pane",{attrs:{label:"收藏者"}},[e("Subscribers",{attrs:{subscribers:t.subscribers,totalcount:t.totalcount},on:{handlePage:t.getSongListSubscribersBy}})],1)],1)],1):t._e()],1)},i=[],n=e("3683"),r=e("5cd6"),l=e("1f56"),o=e("2f62"),c=function(){var t=this,s=t.$createElement,e=t._self._c||s;return 0!==Object.keys(t.playlist).length?e("div",{staticClass:"top-desc"},[e("div",{staticClass:"left-img"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.cover,expression:"cover"}],attrs:{alt:""}})]),e("div",{staticClass:"right-desc"},[e("div",{staticClass:"title"},[e("el-tag",{staticClass:"stag",attrs:{effect:"plain"}},[t._v("歌单")]),e("h2",[t._v(t._s(t.playlist.name))])],1),e("div",{staticClass:"creator-info"},[e("div",{staticClass:"avatar",on:{click:t.toUserDetail}},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.playlist.creator.avatarUrl+"?param=80y80",expression:"playlist.creator.avatarUrl + '?param=80y80'"}],attrs:{alt:""}})]),e("div",{staticClass:"uname",on:{click:t.toUserDetail}},[e("span",[t._v(t._s(t.playlist.creator.nickname))])]),e("div",{staticClass:"creat-time"},[t.playlist.createTime&&!t.playlist.ToplistType?e("p",[t._v("创建时间："+t._s(t._f("showDate")(t.playlist.createTime)))]):t._e(),t.playlist.ToplistType&&t.playlist.trackUpdateTime?e("p",[t._v("最近更新时间："+t._s(t._f("showDate")(t.playlist.trackUpdateTime)))]):t._e()])]),e("div",{staticClass:"operation"},[e("el-button",{attrs:{type:"primary",icon:"el-icon-video-play"},on:{click:t.playAll}},[t._v("播放全部")]),null==t.$store.state.userInfo||t.$store.state.userInfo.userId&&t.playlist.creator.userId!=t.$store.state.userInfo.userId?e("el-button",{attrs:{icon:t.isSub?"el-icon-folder-checked":"el-icon-folder-add",type:t.isSub?"primary":"default"},on:{click:t.subSongList}},[e("span",[t._v(t._s(t.isSub?"已收藏":"收藏"))])]):t._e(),e("el-button",{attrs:{icon:"el-icon-share"}},[t._v("分享("+t._s(t._f("formatNum")(t.playlist.shareCount))+")")])],1),0!==t.playlist.tags.length?e("div",{staticClass:"tags"},[e("span",[t._v("标签：")]),t._l(t.playlist.tags,(function(s,a){return e("span",{key:a,staticClass:"tags-item"},[e("el-tag",{attrs:{effect:"plain",size:"small"}},[t._v(t._s(s))])],1)}))],2):t._e(),e("div",{staticClass:"song-count"},[e("span",[t._v("歌曲："+t._s(t.playlist.trackIds.length)+"首")]),e("span",[t._v("播放："+t._s(t._f("formatNum")(t.playlist.playCount))+"次")])]),e("div",{staticClass:"desc-info"},[t.playlist.description?e("span",[t._v("简介："+t._s(t.playlist.description))]):e("span",[t._v("简介：暂无简介")])])])]):t._e()},u=[],d=e("0df0"),p={name:"Topdesc",props:{playlist:{type:Object,default(){return{}}},isSub:{type:Boolean,default(){return!1}}},data(){return{}},computed:{cover(){return this.playlist.coverImgUrl+"?param=200y200"}},filters:{showDate(t){const s=new Date(t);return Object(d["a"])(s,"yyyy-MM-dd")}},methods:{playAll(){this.$emit("playAllSong")},subSongList(){this.$store.state.isLogin?this.$emit("subSongListBy"):this.$message({type:"warning",message:"登录后才能收藏",showClose:!0,center:!0})},toUserDetail(){this.$router.push("/userdetail/"+this.playlist.creator.userId)}}},h=p,g=(e("46fe"),e("2877")),m=Object(g["a"])(h,c,u,!1,null,"61ebb887",null),b=m.exports,f=e("5501"),y=e("40a1"),v=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"subscribers"},[0!==t.subscribers.length?e("UserList",{attrs:{userlist:t.subscribers}}):t._e(),e("Pagination",{attrs:{total:t.totalcount,"page-size":48},on:{handleCurrentChange:t.handleCurrentChange}}),0==t.subscribers.length?e("div",{staticClass:"no"},[e("el-empty",{attrs:{description:"暂无收藏者","image-size":200}})],1):t._e()],1)},S=[],_=e("5e65"),w={name:"Subscribers",components:{UserList:_["a"]},props:{subscribers:{type:Array,default(){return[]}},totalcount:{type:Number,default:0}},methods:{toUserDetail(t){this.$router.push("/userdetail/"+t)},handleCurrentChange(t){this.$emit("handlePage",t)}}},C=w,k=(e("7ad4"),Object(g["a"])(C,v,S,!1,null,"3301402c",null)),$=k.exports,I={inject:["reload"],name:"Songlistdetail",components:{Topdesc:b,CommentPage:f["a"],SongTable:y["a"],Subscribers:$},data(){return{id:"",playlist:{},songids:"",songs:[],subscribers:[],totalcount:0,isSub:!1}},computed:{...Object(o["b"])(["userSongList","userInfo"])},created(){this.id=this.$route.params.id,this.getSongListDetailBy(),this.getSongListSubscribersBy(),this.isSubSongList()},methods:{getSongListDetailBy(){Object(n["b"])(this.id).then(t=>{this.playlist=t.data.playlist,this.playlist.trackIds.length>1e3?this.playlist.trackIds.slice(0,500).forEach(t=>{this.songids+=t.id+","}):this.playlist.trackIds.forEach(t=>{this.songids+=t.id+","});let s=this.songids.substr(0,this.songids.length-1);Object(n["a"])(s).then(t=>{200==t.data.code&&(this.songs=t.data.songs)})})},getSongListSubscribersBy(t=1){let s=48*(t-1);Object(n["c"])(this.id,s).then(t=>{this.subscribers=t.data.subscribers,this.totalcount=t.data.total})},changePage(){let t=document.querySelector(".view");t.scrollTo({top:300})},playAllSong(){this.$store.dispatch("addAllSong",this.songs),Object(r["d"])(this.songs[0].id).then(t=>{this.$store.dispatch("saveSongUrl",t.data.data[0].url),this.$store.dispatch("changePlayState",!0)}),this.$store.dispatch("saveSongDetail",this.songs[0])},isSubSongList(){let t=this.userSongList.findIndex(t=>t.id==this.id);this.isSub=-1!=t},subSongListBy(){let t=this.isSub?2:1;Object(n["d"])(t,this.id).then(s=>{200==s.data.code&&(this.isSub=!this.isSub,Object(l["f"])(this.userInfo.userId).then(s=>{this.setItem("userSongList",s.data.playlist),this.$store.dispatch("saveUserSongList",s.data.playlist),1==t?this.$message({type:"success",message:"收藏成功",center:!0}):this.$message({type:"success",message:"取消收藏成功",center:!0})}))}).catch(t=>this.$message.warning("操作失败,请重试"))},updateSonglist(){this.getSongListDetailBy(),setTimeout(()=>{this.reload()},1e3)}},watch:{$route(t,s){t!==s&&this.reload()}}},L=I,O=Object(g["a"])(L,a,i,!1,null,"670f5454",null);s["default"]=O.exports},d3e1:function(t,s,e){},f927:function(t,s,e){"use strict";e("01c0")}}]);
//# sourceMappingURL=chunk-598bd39c.e0d6ec05.js.map