(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d8c7e788"],{"055c":function(t,e,s){"use strict";s.d(e,"a",(function(){return i})),s.d(e,"c",(function(){return n})),s.d(e,"b",(function(){return o}));var a=s("1bab");function i(){return Object(a["b"])({url:"/album/sublist",params:{timestamp:Date.parse(new Date),limit:48}})}function n(){return Object(a["b"])({url:"/artist/sublist",params:{timestamp:Date.parse(new Date),limit:48}})}function o(){return Object(a["b"])({url:"/mv/sublist",params:{timestamp:Date.parse(new Date),limit:40}})}},"2bec":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"w",attrs:{id:"album-detail"}},[s("AlbumTopInfo",{attrs:{dynamic:t.dynamic,albuminfo:t.albuminfo,"is-sub":t.isSub},on:{playAllSong:t.playAllSong,subAlbumBy:t.subAlbumBy}}),0!==Object.keys(t.dynamic).length?s("div",{staticClass:"singer-works"},[s("el-tabs",[s("el-tab-pane",{attrs:{label:"歌曲列表"}},[s("SongTable",{attrs:{songs:t.albumsong}})],1),s("el-tab-pane",[s("span",{attrs:{slot:"label"},slot:"label"},[t._v("评论")]),s("CommentPage",{attrs:{"comment-type":3,"commentres-id":t.id},on:{changePage:t.changePage}})],1),s("el-tab-pane",{attrs:{label:"专辑详情"}},[s("div",{staticClass:"album-desc"},[t.albuminfo.description?s("p",{domProps:{innerHTML:t._s(t.albuminfo.description)}}):s("el-empty",{attrs:{description:"暂无介绍","image-size":200}})],1)])],1)],1):t._e()],1)},i=[],n=s("1bab");function o(t){return Object(n["b"])({url:"/album",params:{id:t}})}function l(t){return Object(n["b"])({url:"/album/detail/dynamic",params:{id:t}})}function r(t,e){return Object(n["b"])({url:"/album/sub",params:{t:t,id:e,timestamp:Date.parse(new Date)}})}var c=s("5cd6"),u=s("055c"),d=s("2f62"),m=function(){var t=this,e=t.$createElement,s=t._self._c||e;return 0!==Object.keys(t.albuminfo).length?s("div",{staticClass:"top-desc"},[s("div",{staticClass:"left-img"},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.cover,expression:"cover"}],attrs:{alt:""}})]),s("div",{staticClass:"right-desc"},[s("div",{staticClass:"title"},[s("el-tag",{staticClass:"stag",attrs:{effect:"plain"}},[t._v("专辑")]),s("h2",[t._v(t._s(t.albuminfo.name))])],1),s("div",{staticClass:"operation"},[s("el-button",{attrs:{type:"primary",icon:"el-icon-video-play"},on:{click:t.playAll}},[t._v("播放全部")]),s("el-button",{attrs:{icon:t.isSub?"el-icon-folder-checked":"el-icon-folder-add",type:t.isSub?"primary":"default"},on:{click:t.subAlbumBy}},[t._v(t._s(t.isSub?"已收藏":"收藏"))]),s("el-button",{attrs:{icon:"el-icon-share"}},[t._v("分享("+t._s(t.dynamic.shareCount)+")")])],1),s("div",{staticClass:"base-info"},[s("div",[t._v("歌手："+t._s(t.albuminfo.artist.name))]),s("div",[t._v("歌曲数："+t._s(t.albuminfo.size))]),t.albuminfo.company?s("div",[t._v("出品公司："+t._s(t.albuminfo.company))]):t._e(),s("div",[t._v("发行时间："+t._s(t._f("showDate")(t.albuminfo.publishTime)))])])])]):t._e()},b=[],h=s("0df0"),p={name:"AlbumTopInfo",props:{dynamic:{type:Object,default(){return{}}},albuminfo:{type:Object,default(){return{}}},isSub:{type:Boolean,default(){return!1}}},computed:{cover(){return this.albuminfo.picUrl+"?param=200y200"}},filters:{showDate(t){const e=new Date(t);return Object(h["a"])(e,"yyyy-MM-dd")}},data(){return{}},methods:{playAll(){this.$emit("playAllSong")},subAlbumBy(){this.$store.state.isLogin?this.$emit("subAlbumBy"):this.$message({type:"warning",message:"登录后才能收藏",showClose:!0,center:!0})}}},g=p,f=(s("6a60"),s("2877")),y=Object(f["a"])(g,m,b,!1,null,"e890924a",null),v=y.exports,w=s("40a1"),S=s("5501"),_={name:"Albumdetail",components:{AlbumTopInfo:v,SongTable:w["a"],CommentPage:S["a"]},data(){return{id:"",dynamic:{},albuminfo:{},albumsong:[],isSub:!1}},computed:{...Object(d["b"])(["subAlbumlist"])},created(){this.id=this.$route.params.id,this.getAlbumDynamicBy(),this.getAlbumSongBy(),0!=this.subAlbumlist.length?this.isSubAlbum():this.getUserSubAlbum()},methods:{getAlbumDynamicBy(){l(this.id).then(t=>{this.dynamic=t.data})},getAlbumSongBy(){o(this.id).then(t=>{this.albuminfo=t.data.album,this.albumsong=t.data.songs})},changePage(t){let e=document.querySelector(".view");e.scrollTo({behavior:"smooth",top:300})},playAllSong(){this.$store.dispatch("addAllSong",this.albumsong),Object(c["d"])(this.albumsong[0].id).then(t=>{this.$store.dispatch("saveSongUrl",t.data.data[0].url)}),this.$store.dispatch("saveSongDetail",this.albumsong[0])},getUserSubAlbum(){Object(u["a"])().then(t=>{this.$store.dispatch("saveFavoriteAlbum",t.data.data),this.isSubAlbum()})},isSubAlbum(){let t=this.subAlbumlist.findIndex(t=>t.id==this.id);this.isSub=-1!=t},subAlbumBy(){let t=this.isSub?2:1;r(t,this.id).then(e=>{console.log(e),200==e.data.code&&(this.getUserSubAlbum(),1==t?this.$message({type:"success",message:"收藏成功",center:!0}):this.$message({type:"success",message:"取消收藏成功",center:!0}))}).catch(t=>this.$message.warning("操作失败,请重试"))}}},k=_,A=(s("e3ef"),Object(f["a"])(k,a,i,!1,null,"43951388",null));e["default"]=A.exports},"316a":function(t,e,s){"use strict";s("6856")},"40a1":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"song-table"},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.songs,"empty-text":"数据加载中~","row-class-name":t.tableRowClassName},on:{"row-dblclick":t.playMusic}},[s("el-table-column",{attrs:{width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.id==t.nowSongDetail.id?s("span",{staticClass:"iconfont",class:t.isPlaying?" icon-voice":"icon-jingyin_laba"}):s("span",[t._v(t._s(t._f("formatIndex")(e.row.index)))])]}}])}),s("el-table-column",{attrs:{width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"operation"},[s("span",{class:-1!==t.likeSongIds.indexOf(e.row.id)?"iconfont icon-xihuan2":"iconfont icon-xihuan",attrs:{title:-1!==t.likeSongIds.indexOf(e.row.id)?"取消喜欢":"喜欢"},on:{click:function(s){return t.likeSong(e.row)}}}),s("span",{staticClass:"iconfont icon-xiazai",attrs:{title:"下载"},on:{click:function(s){return t.downloadCurrentMusic(e.row)}}}),s("span",{staticClass:"el-icon-plus",attrs:{title:"添加到播放列表"},on:{click:function(s){return t.addSong(e.row)}}})])]}}])}),s("el-table-column",{attrs:{prop:"name",label:"歌曲",width:"300","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"songname"},[t._v(" "+t._s(e.row.name)+" "),1==e.row.fee?s("i",{staticClass:"iconfont icon-vip"}):t._e(),0!=e.row.mv?s("i",{staticClass:"iconfont icon-mv",on:{click:function(s){return t.toMvDetail(e.row.mv)}}}):t._e()])]}}])}),s("el-table-column",{attrs:{prop:"al.name",label:"专辑","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",{staticClass:"sthover",on:{click:function(s){return t.toAlbum(e.row.al.id)}}},[t._v(" "+t._s(e.row.al.name)+" ")])]}}])}),s("el-table-column",{attrs:{prop:"ar[0].name",label:"歌手","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",{staticClass:"sthover",on:{click:function(s){return t.toSinger(e.row.ar[0].id)}}},[t._v(" "+t._s(e.row.ar[0].name)+" ")])]}}])}),s("el-table-column",{attrs:{prop:"dt",label:"时长"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(" "+t._s(t._f("formatDuration")(e.row.dt))+" ")])]}}])})],1)],1)},i=[],n=s("5cd6"),o=s("2f62"),l={name:"SongTable",props:{songs:{type:Array,default(){return[]}}},data(){return{islike:!1,currentIndex:null}},computed:{...Object(o["b"])(["isPlaying","nowSongDetail","isLogin","userInfo","userSongList","likeSongIds"])},filters:{formatIndex(t){return t<9?"0"+(t+1):t+1}},created(){this.isLogin&&0===this.likeSongIds.length&&this.getUserLikSongs()},methods:{playMusic(t){Object(n["a"])(t.id).then(e=>{Object(n["d"])(t.id).then(t=>{this.$store.dispatch("saveSongUrl",t.data.data[0].url)}),this.$store.dispatch("changePlayState",!0),this.$store.dispatch("saveSongDetail",t),this.$store.dispatch("addPlayinglist",t)}).catch(t=>{this.$message({message:"暂时无法播放，换首试试",type:"warning",center:!0})})},getUserLikSongs(){Object(n["b"])(this.userInfo.userId).then(t=>{Array.isArray(t.data.ids)&&0!=t.data.ids.length&&this.$store.dispatch("saveLikeSongIds",t.data.ids)})},likeSong(t){if(!this.$store.state.isLogin)return void this.$message({type:"warning",message:"登录后才能收藏",showClose:!0,center:!0});let e=-1===this.likeSongIds.indexOf(t.id);this.userSongList[0].id!=this.$route.params.id?this.likeNowSongBy(t,e):this.$confirm("确定将选中歌曲从我喜欢的音乐中删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",confirmButtonClass:""}).then(()=>{this.likeNowSongBy(t,e),this.$emit("updateSonglist")}).catch(t=>{})},likeNowSongBy(t,e){Object(n["e"])(t.id,e).then(t=>{this.getUserLikSongs(),!0===e?(this.$message({message:"已添加到我喜欢的音乐",type:"success",center:!0}),this.islike=!0):(this.$message({message:"取消喜欢成功",type:"success",center:!0}),this.islike=!1)}).catch(t=>{this.$message.warning("操作失败,请重试")})},downloadCurrentMusic(t){Object(n["a"])(t.id).then(e=>{Object(n["d"])(t.id).then(e=>{let s=e.data.data[0].url,a={url:s,name:t.name+" - "+t.ar[0].name};this.$store.commit("updateDownloadMusicInfo",a)})}).catch(t=>{this.$message({message:"暂无版权，无法下载",type:"warning",center:!0})})},addSong(t){this.$store.dispatch("addPlayinglist",t),this.$message({message:"已添加到播放列表",type:"success",center:!0})},toSinger(t){this.$router.push("/singerdetail/"+t)},toAlbum(t){this.$router.push("/albumdetail/"+t)},toMvDetail(t){this.$router.push({name:"VideoDetail",params:{id:t,type:"mv"}})},tableRowClassName({row:t,rowIndex:e}){if(t.index=e,e%2!==0)return"rowEven"}}},r=l,c=(s("316a"),s("2877")),u=Object(c["a"])(r,a,i,!1,null,"2fedf183",null);e["a"]=u.exports},6856:function(t,e,s){},"6a60":function(t,e,s){"use strict";s("849d")},"849d":function(t,e,s){},"9dae":function(t,e,s){},e3ef:function(t,e,s){"use strict";s("9dae")}}]);
//# sourceMappingURL=chunk-d8c7e788.b8b7fec8.js.map